[{"id":0,"href":"/Notes/docs/bellman/","title":"Bellmanův princip optimality","section":"Docs","content":" Bellmanův princip optimality # Pro dynamický systém ve tvaru \\[\\dot{\\bm{x}} = \\bm{f}(\\bm{x},\\bm{u},τ)\\] kde \\( \\bm{x}(τ) \\) jsou stavy systému a \\( \\bm{u} \\) vstupy, můžeme definovat pro trajektorii ze stavu \\( \\bm{x}(t) \\) do stavu \\( \\bm{x}(T) \\) kritérium optimality \\[J_{⟨t,T⟩}(\\bm{u},τ) = ∫_{t}^{T} L(\\bm{x},\\bm{u},τ)\\,dτ\\] Také můzeme definovat tzv. cenou do cíle \\( J^*_{⟨t,T⟩}(τ) \\) pro zpětnovazební řízení \\( \\bm{u}(\\bm{x}(τ)) \\) .\nPak musí existovat minimalizující zpětnovazební řízení \\( \\bm{u}_\\text{opt} \\) \\[\\bm{u}_\\text{opt} = \\argmin_{\\bm{u}} J^*_{⟨t,T⟩}\\] které budeme nazývat optimálním. Bellmanovou funkcí nazýváme cenu do cíle při optimálním řízení \\[V_{⟨t,T⟩} = \\min_{\\bm{u}} J^*_{⟨t,T⟩}\\] Bellmanova rovnice # Pokud hledáme optimální řízení ve stavu \\( \\bm{x}(t) \\) , můžeme rozdělit celou trajektorii na dva úseky:\n\\( \\bm{x}(τ) \\,,\\; τ ∈ ⟨t,t\u0026#43;Δt) \\) s kritériem optimality \\( \\int_t^{t\u0026#43;Δt} L\\,dτ \\) \\( \\bm{x}(τ) \\,,\\; τ ∈ ⟨t\u0026#43;Δt,T⟩ \\) s cenou do cíle \\( J^*_{⟨t\u0026#43;Δt,T⟩} \\) S definovanými úseky můžeme Bellmanovu funkci rozepsat do tvaru tzv. Bellmanovy rovnice \\[V_{⟨t,T⟩} = \\min_{\\bm{u}} \\left( \\int_t^{t\u0026#43;Δt} L\\,dτ \u0026#43; J^*_{⟨t\u0026#43;Δt,T⟩} \\right)\\] Bellmanova diferenciání rovnice # Člen \\( J_{⟨t\u0026#43;Δt,T⟩} \\) můžeme rozepsat jako \\[J^*_{⟨t\u0026#43;Δt,T⟩} = J^*_{⟨t,T⟩} \u0026#43; ∫_{t}^{t\u0026#43;Δt} \\frac{dJ^*}{dτ} dτ\\] kdy dosazením získáme \\[V_{⟨t,T⟩} = \\min_{\\bm{u}} \\left( ∫_t^{t\u0026#43;Δt} L\\,dτ \u0026#43; J^*_{⟨t,T⟩} \u0026#43; ∫_{t}^{t\u0026#43;Δt} \\frac{dJ^*}{dτ} dτ \\right)\\] Jelikož platí \\[V_{⟨t,T⟩} = \\min_{\\bm{u}} \\left( J^*_{⟨t,T⟩} \\right)\\] člen \\( J^*_{⟨t,T⟩} \\) můžeme vykrátit s levou stranou a dále provést úpravu \\[\\frac{dJ^*}{dτ} = \\frac{∂J^*}{∂\\bm{x}} \\bm{f} \u0026#43; \\frac{∂J^*}{∂τ}\\] Výsledkem je po-té rovnice \\[0 = \\min_{\\bm{u}} \\left( ∫_t^{t\u0026#43;Δt} \\left( L \u0026#43; \\frac{∂J^*}{∂\\bm{x}}\\bm{f} \u0026#43; \\frac{∂J^*}{∂τ} \\right) \\ dτ \\right)\\] Pokud \\( Δt→0 \\) , můžeme aproximovat integrál pomocí Reimannova součtu a výslednou rovnici upravit do tvaru tzv. Bellmanovy diferenciální rovnice \\[%\\left. -\\frac{∂J^*}{∂τ} %\\right|_{τ=t} = %\\left. \\min_{\\bm{u}} \\left( L \u0026#43; \\frac{∂J^*}{∂\\bm{x}}\t\\bm{f} \\right) %\\right|_{τ=t}\\] vyjádřené v čase \\( τ = t \\) , kde předpokládáme, že člen \\( \\frac{∂J^*}{∂τ} \\) je nezávislý na \\( \\bm{u} \\) . Z ní lze přímo odvodit LQR a s úpravou, Pontrjaginův princip minima.\n"},{"id":1,"href":"/Notes/docs/bellman/lqr/","title":"Linear Quadratic Regulator","section":"Bellmanův princip optimality","content":" Linear Quadratic Regulator (LQR) # LQR je určen pro regulaci lineárního systému se stavovou zpětnou vazbou ve tvaru \\[\\bm{\\dot{x}} = \\bm{A} \\, \\bm{x} \u0026#43; \\bm{B} \\, \\bm{u} \\;,\\quad \\bm{u} = -\\bm{K}\\bm{x}\\] s kvadratickým kritériem optimality trajektorie \\[J = \\int_{-∞}^{∞} \\underbrace{ \\bm{x}^T \\bm{Q} \\, \\bm{x} \u0026#43; \\bm{u}^T \\bm{R} \\, \\bm{u} }_{L(\\bm{x},\\bm{u},τ)} \\, dτ\\] přičemž \\[\\bm{Q} = \\bm{Q}^T ⪰ 0 \\;,\\quad \\bm{R} = \\bm{R}^T ⪰ 0\\] Jeho syntéza je založena na nalezní řešení Bellmanovy diferenciální rovnice 1 \\[%\\left. -\\frac{∂J^*}{∂τ} %\\right|_{τ=t} = %\\left. \\min_{\\bm{u}} \\left( L \u0026#43; \\frac{∂J^*}{∂\\bm{x}}\t\\bm{f} \\right) %\\right|_{τ=t}\\] vyjádřené v čase \\( τ = t \\) s cenou do cíle \\[J^* = \\bm{x}^T \\bm{S} \\, \\bm{x} \\;,\\quad \\bm{S} = \\bm{S}^T\\] Po dosazení výše uvedených tvarů Bellmanovy funkce, stavového popisu systému a Lagrangiánu, získáváme rovnici \\[0 = \\min_{\\bm{u}} \\left( \\bm{x}^T \\bm{Q} \\, \\bm{x} \u0026#43; \\bm{u}^T \\bm{R} \\, \\bm{u} \u0026#43; 2 \\bm{x}^T \\bm{S} ( \\bm{A} \\bm{x} \u0026#43; \\bm{B} \\bm{u} ) \\right)\\] přičemž z podmínky lokálního extrému \\[\\frac{∂}{∂\\bm{u}} \\left( \\bm{x}^T \\bm{Q} \\, \\bm{x} \u0026#43; \\bm{u}^T \\bm{R} \\, \\bm{u} \u0026#43; 2 \\bm{x}^T \\bm{S} ( \\bm{A} \\bm{x} \u0026#43; \\bm{B} \\bm{u} ) \\right) = 0\\] lze vyjádřit optimální řízení \\( \\bm{u}_\\text{opt}(τ) \\) \\[\\bm{u}_\\text{opt} = - \\bm{R}^{-1} \\bm{B}^T \\bm{S} \\, \\bm{x} \\] které když dosadíme, získáme rovnici \\[0 = \\bm{x}^T \\bm{Q} \\, \\bm{x} \u0026#43; \\bm{x}^T \\bm{S} \\bm{B} \\bm{R}^{-1} \\bm{R} \\bm{R}^{-1} \\bm{B}^T \\bm{S} \\, \\bm{x} \u0026#43; 2 \\bm{x}^T \\bm{S} ( \\bm{A} \\bm{x} - \\bm{B} \\bm{R}^{-1} \\bm{B}^T \\bm{S} \\, \\bm{x} )\\] Tu lze dále upravit na \\[0 = \\bm{x}^T \\left( \\bm{Q} - \\bm{S}\\bm{B}\\bm{R}^{-1} \\bm{B}^T \\bm{S} \u0026#43; \\bm{S}\\bm{A} \u0026#43; \\bm{A}^T \\bm{S} \\right) \\bm{x}\\] která platí pro libovolné \\( \\bm{x}(t) \\) pokud je \\( \\bm{S} \\) řešením tzv. Continuous Algebraic Riccati Equation (C.A.R.E.) \\[\\bm{Q} - \\bm{S}\\bm{B}\\bm{R}^{-1} \\bm{B}^T \\bm{S} \u0026#43; \\bm{S}\\bm{A} \u0026#43; \\bm{A}^T \\bm{S} = 0\\] Belmannův princip optimality\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n"},{"id":2,"href":"/Notes/docs/bellman/pontrjagin/","title":"Pontjaginův princip minima","section":"Bellmanův princip optimality","content":"Přestože Pontrjaginův princip minima byl odvozen nezávisle v sovětském svazu, je možné jej odvodit z Bellmanovy diferenciální rovnice 1 \\[%\\left. -\\frac{∂J^*}{∂τ} %\\right|_{τ=t} = %\\left. \\min_{\\bm{u}} \\left( L \u0026#43; \\frac{∂J^*}{∂\\bm{x}}\t\\bm{f} \\right) %\\right|_{τ=t}\\] Základem je zavedení Hamiltoniánu \\[H = -\\frac{∂J^*}{∂τ}\\] a konjugovaného stavového vektoru \\[\\bm{p} = \\frac{∂J^*}{∂\\bm{x}^T}\\] Bellmanovu diferenciální rovnici pak můžeme psát jako \\[%\\left. H %\\right|_{τ=t} = %\\left. \\min_{\\bm{u}} \\left( L \u0026#43; \\bm{p}^T\t\\bm{f} \\right) %\\right|_{τ=t}\\] kde \\( H \\) je Hamiltonián při dosazení optimálního řízení \\( \\bm{u}_\\text{opt} \\) které jej minimalizuje \\[\\bm{u}_\\text{opt} = \\argmin_{\\bm{u}} H\\] Samotný Hamiltonián lze vyjádřit jako obsah závroky \\[H = L \u0026#43; \\bm{p}^T\t\\bm{f}\\] a z něj odvodit stavové rovnice \\[\\dot{\\bm{x}} = \\frac{∂H}{∂\\bm{p}^T} \\qquad \\dot{\\bm{p}} = -\\frac{∂H}{∂\\bm{x}^T}\\] kde je využito že vektor \\( \\bm{p} \\) je stavový vektor (závislý pouze na \\( τ \\) ) a tedy platí \\[\\frac{d\\bm{p}}{dτ} = \\frac{∂\\bm{p}}{∂τ} = \\frac{∂^2J^*}{∂τ ∂\\bm{x}^T} = -\\frac{∂H}{∂\\bm{x}^T}\\] Belmannův princip optimality\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n"},{"id":3,"href":"/Notes/docs/mpc/","title":"Prediktivní řízení","section":"Docs","content":"Pro diskrétní systémy ve tvaru \\[\\begin{aligned} \\bm{x}_{k\u0026#43;1} \u0026amp;= \\bm{A}\\bm{x}_k \u0026#43; \\bm{B}\\bm{u}_k \\\\ \\bm{y}_k \u0026amp;= \\bm{C}\\bm{x}_k \\end{aligned}\\] existuje forma optimálního řízení, které využívá kvadratického kritéria \\[J_{i\u0026#43;1} = (\\bm{y}_{i\u0026#43;1}-\\bm{w}_{i\u0026#43;1})^T \\bm{Q}_{i\u0026#43;1} (\\bm{y}_{i\u0026#43;1}-\\bm{w}_{i\u0026#43;1}) \u0026#43; \\bm{u}_i^T\\bm{R}_i\\bm{u}_i\\] kde \\( \\bm{w}_{i\u0026#43;1} \\) jsou žádané hodnoty výstupů na horizontu \\[i\u0026#43;1 = k\u0026#43;1,\\dots,k\u0026#43;N\\] pro určení optimálního řízení \\( \\bm{u}^*_i \\) .\nJednotlivé stavy systému \\( \\bm{x}_i \\) můžeme vyjádřit jako \\[\\begin{aligned} \\bm{x}_{k\u0026#43;1} \u0026amp;= \\bm{A}\\bm{x}_k \u0026#43; \\bm{B}\\bm{u}_k \\\\ \\bm{x}_{k\u0026#43;2} \u0026amp;= \\bm{A}^2\\bm{x}_k \u0026#43; \\bm{A}\\bm{B}\\bm{u}_k \u0026#43; \\bm{B}\\bm{u}_{k\u0026#43;1}\\\\ \\bm{x}_{k\u0026#43;n} \u0026amp;= \\bm{A}^n\\bm{x}_k \u0026#43; \\sum_{j=1}^n \\bm{A}^{n-j}\\bm{B}\\bm{u}_{k\u0026#43;j-1} \\end{aligned}\\] přičemž jeho výstupy nabývají hodnot \\[\\bm{y}_{k\u0026#43;n} = \\bm{C}\\bm{A}^n\\bm{x}_k \u0026#43; \\sum_{j=1}^n \\bm{C}\\bm{A}^{n-j}\\bm{B}\\bm{u}_{k\u0026#43;j}\\] Výstupy \\( \\bm{y}_i \\,,\\; i = k\u0026#43;1,\\ldots,k\u0026#43;N \\) můžeme seřadit do vektoru \\[\\bm{Y} = \\bm{f} \u0026#43; \\bm{G}\\bm{U}\\] kde \\[\\bm{Y} = \\begin{bmatrix} \\bm{y}_{k\u0026#43;1} \\\\ \\vdots \\\\ \\bm{y}_{k\u0026#43;N} \\end{bmatrix} \\;,\\quad \\bm{f} = \\begin{bmatrix} \\bm{C}\\bm{A} \\\\ \\vdots \\\\ \\bm{C}\\bm{A}^N \\end{bmatrix} \\bm{x}_k \\;,\\quad \\bm{G} = \\begin{bmatrix} \\bm{C}\\bm{B} \u0026amp; \u0026amp; \\bm{0} \\\\ \\vdots \u0026amp; \\ddots \u0026amp; \\\\ \\bm{C}\\bm{A}^{N-1}\\bm{B} \u0026amp; \\dots \u0026amp; \\bm{C}\\bm{B} \\end{bmatrix} \\;,\\quad \\bm{U} = \\begin{bmatrix} \\bm{u}_{k} \\\\ \\vdots \\\\ \\bm{u}_{k\u0026#43;N-1} \\end{bmatrix}\\] Pro celý horizont můžeme utvořit kvadratické kritérium optimality \\[J = (\\bm{W}-\\bm{Y})^T \\bm{Q} (\\bm{W}-\\bm{Y}) \u0026#43; \\bm{U}^T\\bm{R}\\bm{U}\\] kde \\( \\bm{Q} \\) a \\( \\bm{R} \\) jsou váhové matice a \\( \\bm{W} \\) vektor žádaných výstupů \\[\\bm{W} = \\begin{bmatrix} \\bm{w}_{k\u0026#43;1} \\\\ \\vdots \\\\ \\bm{w}_{k\u0026#43;N} \\end{bmatrix} \\;,\\quad \\bm{Q} = \\begin{bmatrix} \\bm{Q}_{k\u0026#43;1} \u0026amp; \u0026amp; \\bm{0} \\\\ \\vdots \u0026amp; \\ddots \u0026amp; \\\\ \\bm{0} \u0026amp; \\dots \u0026amp; \\bm{Q}_{k\u0026#43;N} \\end{bmatrix} \\;,\\quad \\bm{R} = \\begin{bmatrix} \\bm{R}_{k} \u0026amp; \u0026amp; \\bm{0} \\\\ \\vdots \u0026amp; \\ddots \u0026amp; \\\\ \\bm{0} \u0026amp; \\dots \u0026amp; \\bm{R}_{k\u0026#43;N-1} \\end{bmatrix}\\] Po dozazení \\( \\bm{Y} = \\bm{f} \u0026#43; \\bm{G}\\bm{U} \\) můžeme najít jeho minimum pomocí podmínky \\[\\frac{∂J}{∂\\bm{U}} = \\bm{0}\\] "}]